<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Birthday Memory Quest</title>
  <style>
    :root{
      --bg1:#ff8bd8;--bg2:#7b5cff;--card-back:#ffffff22;--accent:#fff;
      --glass: rgba(255,255,255,0.08);
      --glass-2: rgba(255,255,255,0.04);
      --shadow: 0 6px 18px rgba(0,0,0,0.25);
      font-family: 'Segoe UI', Roboto, system-ui, -apple-system, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      background: linear-gradient(135deg,var(--bg1),var(--bg2));
      color:#fff;display:flex;align-items:center;justify-content:center;padding:20px;
    }

    .app{width:100%;max-width:980px;background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.03));border-radius:18px;padding:18px;box-shadow:var(--shadow)}
    header{display:flex;align-items:center;gap:12px}
    header h1{margin:0;font-size:20px}
    .controls{margin-left:auto;display:flex;gap:8px}
    button{background:transparent;border:2px solid rgba(255,255,255,0.12);color:var(--accent);padding:8px 14px;border-radius:12px;cursor:pointer}
    button.primary{background:rgba(255,255,255,0.12);border-color:transparent}

    main{margin-top:18px}
    .screen{display:none;animation:fade .35s ease both}
    .screen.active{display:block}
    @keyframes fade{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}

    /* Welcome */
    .welcome{display:flex;flex-direction:column;align-items:center;gap:14px;padding:28px;text-align:center}
    .title-hero{font-size:28px;font-weight:700}
    .start-btn{font-size:18px;padding:12px 22px}

    /* Game area */
    .game-area{display:flex;flex-direction:column;gap:14px;align-items:center}
    .grid{display:grid;gap:12px;justify-content:center}

    .card{width:86px;height:110px;border-radius:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;perspective:900px}
    .card-inner{width:100%;height:100%;border-radius:10px;position:relative;transform-style:preserve-3d;transition:transform .45s cubic-bezier(.2,.9,.3,1)}
    .card.flipped .card-inner{transform:rotateY(180deg)}
    .face{position:absolute;inset:0;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:34px;backface-visibility:hidden}
    .face.back{transform:rotateY(180deg);background:linear-gradient(180deg,#fff,#fff);color:#333}
    .face.front{background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(0,0,0,0.04));border:2px solid rgba(255,255,255,0.06)}

    .status{display:flex;gap:12px;align-items:center}

    /* Final card */
    .surprise{display:flex;flex-direction:column;align-items:center;gap:12px;padding:18px}
    .card-wrap{width:320px;height:200px;perspective:1200px}
    .gift{width:100%;height:100%;border-radius:12px;background:linear-gradient(120deg,#fff,#ffe6f7);color:#333;transform-origin:left center;transition:transform .8s ease;box-shadow:0 20px 40px rgba(0,0,0,0.28);position:relative}
    .gift.flipped{transform:rotateY(-180deg)}
    .gift .page{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:18px}
    .page.front{backface-visibility:hidden}
    .page.back{transform:rotateY(180deg);backface-visibility:hidden}

    .confetti-area{position:fixed;left:0;right:0;top:0;bottom:0;pointer-events:none;overflow:hidden}
    .confetti{position:absolute;width:10px;height:16px;opacity:0.95;transform-origin:center;animation:fall 3s linear both}
    @keyframes fall{to{transform:translateY(110vh) rotate(600deg);opacity:0}}

    /* responsive */
    @media (max-width:600px){.card{width:68px;height:90px;font-size:28px}}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Birthday Memory Quest</h1>
      <div class="controls">
        <button id="muteBtn">üîà</button>
        <button id="resetBtn">Reset</button>
      </div>
    </header>

    <main>
      <!-- Welcome -->
      <section id="welcome" class="screen active">
        <div class="welcome">
          <div class="title-hero">üéÅ Welcome to your Birthday Treasure Quest!</div>
          <div style="max-width:720px">Flip & memorize matching cards in levels 1 and 2 ‚Äî then solve the final riddle to open your surprise card.</div>
          <div style="display:flex;gap:12px">
            <button class="primary start-btn" id="startBtn">Start the Hunt</button>
            <button id="howBtn">How to play</button>
          </div>
        </div>
      </section>

      <!-- Level 1 -->
      <section id="level1" class="screen">
        <div class="game-area">
          <div style="font-weight:700">Level 1 ‚Äî Match the 3 pairs</div>
          <div class="status"><div id="l1moves">Moves: 0</div><div id="l1matches">Matches: 0 / 3</div></div>
          <div id="grid1" class="grid"></div>
          <div><button id="toLevel2" style="display:none">Next Level</button></div>
        </div>
      </section>

      <!-- Level 2 -->
      <section id="level2" class="screen">
        <div class="game-area">
          <div style="font-weight:700">Level 2 ‚Äî Match the 6 pairs</div>
          <div class="status"><div id="l2moves">Moves: 0</div><div id="l2matches">Matches: 0 / 6</div></div>
          <div id="grid2" class="grid"></div>
          <div><button id="toLevel3" style="display:none">Final Riddle</button></div>
        </div>
      </section>

      <!-- Level 3 -->
      <section id="level3" class="screen">
        <div style="text-align:center;padding:18px">
          <div style="font-weight:700">Level 3 ‚Äî Final Riddle</div>
          <p>"You cut me on birthdays but I never bleed. What am I?"</p>
          <input id="riddleAnswer" placeholder="Type your answer..." style="padding:10px;border-radius:8px;border:2px solid rgba(255,255,255,0.06);width:200px;text-align:center" />
          <div style="margin-top:10px"><button id="submitRiddle">Submit</button></div>
          <div id="riddleMsg" style="margin-top:8px;min-height:20px"></div>
        </div>
      </section>

      <!-- Surprise -->
      <section id="surprise" class="screen">
        <div class="surprise">
          <div style="font-weight:700">Surprise!</div>
          <div class="card-wrap">
            <div id="gift" class="gift">
              <div class="page front">
                <div style="text-align:center">
                  <h2 style="margin:4px 0">üéâ Happy Birthday!</h2>
                  <p style="margin:4px 0">Tap to open your card</p>
                </div>
              </div>
              <div class="page back">
                <div style="text-align:center;display:flex;flex-direction:column;gap:8px;align-items:center">
                  <div style="font-size:16px;font-weight:700">A special wish just for you</div>
                  <div style="max-width:260px">May your day be full of joy, laughter, and wonderful surprises. You are loved ‚Äî always.</div>
                  <img id="surpriseImg" src="surprise.jpg" alt="surprise" style="width:160px;border-radius:10px;display:block;object-fit:cover" />
                </div>
              </div>
            </div>
          </div>
          <div style="display:flex;gap:8px">
            <button id="flipCardBtn">Flip Card</button>
            <button id="replayBtn">Play Again</button>
          </div>
        </div>
      </section>

    </main>
  </div>

  <div class="confetti-area" id="confettiArea"></div>

  <!-- Background music (place music.mp3 in same folder) -->
  <audio id="bgm" src="music.mp3" loop></audio>

  <script>
    // --- Helper utilities ---
    const $ = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));

    // Screens
    const screens = {welcome:$('#welcome'), level1:$('#level1'), level2:$('#level2'), level3:$('#level3'), surprise:$('#surprise')};
    function show(screen){ Object.values(screens).forEach(s=>s.classList.remove('active')); screens[screen].classList.add('active'); }

    // Music controls
    const bgm = $('#bgm'); const muteBtn = $('#muteBtn'); let muted=false;
    muteBtn.addEventListener('click',()=>{ muted=!muted; bgm.muted=muted; muteBtn.textContent = muted? 'üîá':'üîà'; });

    // Start
    $('#startBtn').addEventListener('click',()=>{ bgm.play().catch(()=>{}); show('level1'); startLevel1(); generateConfetti(16); });
    $('#resetBtn').addEventListener('click',()=>location.reload());
    $('#howBtn').addEventListener('click',()=>alert('Flip cards to find matching pairs. Level 1 has 3 pairs, Level 2 has 6 pairs. Then solve the final riddle to reveal the surprise card.'))

    // --- Memory Game Logic ---
    function createGrid(container, items, cols){
      container.innerHTML='';
      container.style.gridTemplateColumns = `repeat(${cols}, auto)`;
      items.forEach((symbol, idx)=>{
        const card = document.createElement('div'); card.className='card'; card.dataset.symbol=symbol; card.dataset.idx=idx;
        const inner = document.createElement('div'); inner.className='card-inner';
        const f1 = document.createElement('div'); f1.className='face front'; f1.innerHTML='';
        const f2 = document.createElement('div'); f2.className='face back'; f2.innerHTML=symbol;
        inner.appendChild(f1); inner.appendChild(f2); card.appendChild(inner);
        container.appendChild(card);
      });
    }

    function shuffle(a){ for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]] } return a }

    // Level 1 (3 pairs)
    let l1State={first:null,second:null,lock:false,moves:0,matches:0};
    function startLevel1(){
      const symbols=['üéà','üéÇ','üéÅ'];
      const pool = shuffle([...symbols,...symbols]);
      createGrid($('#grid1'), pool, 3);
      l1State={first:null,second:null,lock:false,moves:0,matches:0};
      updateL1Status();
      $('#grid1').addEventListener('click', l1Click);
    }
    function updateL1Status(){ $('#l1moves').textContent = 'Moves: '+l1State.moves; $('#l1matches').textContent = 'Matches: '+l1State.matches+' / 3'; }
    function l1Click(e){ const card = e.target.closest('.card'); if(!card||l1State.lock) return; if(card.classList.contains('flipped')) return; card.classList.add('flipped');
      if(!l1State.first){ l1State.first = card; return }
      l1State.second = card; l1State.lock = true; l1State.moves++;
      if(l1State.first.dataset.symbol === l1State.second.dataset.symbol){ // match
        l1State.matches++; l1State.first=null; l1State.second=null; l1State.lock=false; updateL1Status(); if(l1State.matches===3) level1Complete();
      } else { setTimeout(()=>{ l1State.first.classList.remove('flipped'); l1State.second.classList.remove('flipped'); l1State.first=null; l1State.second=null; l1State.lock=false; updateL1Status(); },700); }
      updateL1Status(); }
    function level1Complete(){ generateConfetti(20); $('#toLevel2').style.display='inline-block'; $('#toLevel2').addEventListener('click',()=>{ $('#grid1').removeEventListener('click', l1Click); show('level2'); startLevel2(); }); }

    // Level 2 (6 pairs)
    let l2State={first:null,second:null,lock:false,moves:0,matches:0};
    function startLevel2(){
      const symbols=['üåü','üíñ','üç∞','üì∏','üéµ','üå∏'];
      const pool = shuffle([...symbols,...symbols]);
      createGrid($('#grid2'), pool, 4);
      l2State={first:null,second:null,lock:false,moves:0,matches:0}; updateL2Status();
      $('#grid2').addEventListener('click', l2Click);
    }
    function updateL2Status(){ $('#l2moves').textContent = 'Moves: '+l2State.moves; $('#l2matches').textContent = 'Matches: '+l2State.matches+' / 6'; }
    function l2Click(e){ const card = e.target.closest('.card'); if(!card||l2State.lock) return; if(card.classList.contains('flipped')) return; card.classList.add('flipped');
      if(!l2State.first){ l2State.first = card; return }
      l2State.second = card; l2State.lock = true; l2State.moves++;
      if(l2State.first.dataset.symbol === l2State.second.dataset.symbol){ l2State.matches++; l2State.first=null; l2State.second=null; l2State.lock=false; updateL2Status(); if(l2State.matches===6) level2Complete(); }
      else { setTimeout(()=>{ l2State.first.classList.remove('flipped'); l2State.second.classList.remove('flipped'); l2State.first=null; l2State.second=null; l2State.lock=false; updateL2Status(); },700); }
      updateL2Status(); }
    function level2Complete(){ generateConfetti(24); $('#toLevel3').style.display='inline-block'; $('#toLevel3').addEventListener('click',()=>{ $('#grid2').removeEventListener('click', l2Click); show('level3'); }); }

    // Level 3 Riddle
    $('#submitRiddle').addEventListener('click', ()=>{ const val = $('#riddleAnswer').value.trim().toLowerCase(); if(!val) { $('#riddleMsg').textContent='Please type an answer.'; return } if(['cake','birthday cake','the cake'].includes(val)){ $('#riddleMsg').textContent='Correct! Opening surprise...'; generateConfetti(40); setTimeout(()=>show('surprise'),900); } else { $('#riddleMsg').textContent='Not quite ‚Äî try again!'; } });

    // Surprise card flip
    const gift = $('#gift'); $('#flipCardBtn').addEventListener('click', ()=>{ gift.classList.toggle('flipped'); });
    gift.addEventListener('click', ()=>{ gift.classList.toggle('flipped'); });

    // Replay
    $('#replayBtn').addEventListener('click', ()=>{ location.reload(); });

    // Simple confetti generator (creates short lived elements)
    function generateConfetti(count=20){ const area = $('#confettiArea'); const colors = ['#ffdd57','#ff7ab6','#7b5cff','#56f0ff','#ffd1f0']; for(let i=0;i<count;i++){ const el = document.createElement('div'); el.className='confetti'; el.style.left = Math.random()*100+'%'; el.style.top = (-10 - Math.random()*20)+'vh'; el.style.width = (6 + Math.random()*8)+'px'; el.style.height = (10 + Math.random()*12)+'px'; el.style.background = colors[Math.floor(Math.random()*colors.length)]; el.style.transform = `rotate(${Math.random()*360}deg)`; el.style.animationDuration = (2.4 + Math.random()*1.6)+'s'; area.appendChild(el); setTimeout(()=>el.remove(),4000); } }

    // Auto-play music in some browsers may not work until user interacts ‚Äî start on first click
    document.addEventListener('click', ()=>{ if(bgm.paused && !muted){ bgm.play().catch(()=>{}); } },{once:true});

    // small UX: allow Enter to submit riddle
    $('#riddleAnswer').addEventListener('keydown',(e)=>{ if(e.key==='Enter') $('#submitRiddle').click(); });

    // Notes: replace music.mp3 and surprise.jpg in same folder for audio + image
  </script>
</body>
</html>
